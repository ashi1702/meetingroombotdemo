{
  "botId": "trendmeetingroombot",
  "botRequest": {
    "type": "message",
    "id": "H8T6XR4Q9u1",
    "timestamp": "2017-06-18T14:50:05.0923146Z",
    "serviceUrl": "https://CortanaBFChannelWestUS.azurewebsites.net/",
    "channelId": "cortana",
    "from": {
      "id": "C809AFBF3AA1545032E7035492F897A0FAA3C09F16005BC443339BB3764BE82F"
    },
    "conversation": {
      "id": "642304c3-bc64-4796-8ae7-f7499aab04f0"
    },
    "recipient": {
      "id": "trendmeetingroombot"
    },
    "locale": "en-US",
    "text": "hi",
    "entities": [
      {
        "type": "Intent",
        "name": "None",
        "entities": []
      },
      {
        "type": "AuthorizationToken",
        "token": "eyJ0eXAiOiJKV1QiLCJub25jZSI6IkFRQUJBQUFBQUFCbmZpRy1tQTZOVGFlN0NkV1c3UWZkWVpzV19hR3VqTTVpSmFQWGl5MzB1SEVfd0Z2Q2JvZ0xncDE3WHZqRGNwNmVabDB1RGRER3VwTVZBazV1TWQzTGprX0JZTy04Wmhqd09kcG1sdnBLSVNBQSIsImFsZyI6IlJTMjU2IiwieDV0IjoiOUZYRHBiZk1GVDJTdlF1WGg4NDZZVHdFSUJ3Iiwia2lkIjoiOUZYRHBiZk1GVDJTdlF1WGg4NDZZVHdFSUJ3In0.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC83MmY5ODhiZi04NmYxLTQxYWYtOTFhYi0yZDdjZDAxMWRiNDcvIiwiaWF0IjoxNDk3Nzk1OTkxLCJuYmYiOjE0OTc3OTU5OTEsImV4cCI6MTQ5Nzc5OTg5MSwiYWNyIjoiMSIsImFpbyI6IlkyWmdZRmk3ek5hVFVlb2gyK0xOaHB4eGg3c2FiZ1RiUHBTVVVEbFVlSXd4OEpiUTVOTUEiLCJhbXIiOlsicHdkIiwibWZhIl0sImFwcF9kaXNwbGF5bmFtZSI6IlRyZW5kIE1pY3JvIE1lZXRpbmcgUm9vbSBCb3QiLCJhcHBpZCI6ImU0NWE3N2I2LWY5NDgtNGQyYi1hOGU2LTRlYThkNjMwYWNjOCIsImFwcGlkYWNyIjoiMSIsImZhbWlseV9uYW1lIjoiQ2hpIiwiZ2l2ZW5fbmFtZSI6Ik1pY2hhZWwgU0giLCJpbl9jb3JwIjoidHJ1ZSIsImlwYWRkciI6IjEuMzQuMTQ0LjE3IiwibmFtZSI6Ik1pY2hhZWwgU0ggQ2hpIiwib2lkIjoiNzI3YzIyZmItODk4Mi00ZTE2LWFkNTEtMWI3MDdlMTM3ZGViIiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTIxNDY3NzMwODUtOTAzMzYzMjg1LTcxOTM0NDcwNy0xNDkxODk4IiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMwMDAwODI3RkFGQTIiLCJzY3AiOiJVc2VyLlJlYWQiLCJzdWIiOiJHLS1KRXlmUTBKWlp3RU45eGIwMGJFMlhYSXVmQXcyVmJhbEFKWXNHRUl3IiwidGlkIjoiNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3IiwidW5pcXVlX25hbWUiOiJtaWNoaUBtaWNyb3NvZnQuY29tIiwidXBuIjoibWljaGlAbWljcm9zb2Z0LmNvbSIsInV0aSI6IjdkNEJ0dmFJcjB1YUNnTkJBX3djQUEiLCJ2ZXIiOiIxLjAifQ.UBpCO38hl7pGznBF4bK_GPtpq0Z9DrpwuCrc1wR6wtZ1bCaiHH-iRBZ5J8ZA9hUrq31WxjV4yPPrr7jX9yjNLi37rrYkW1kFu3UFhx2JvVhg4iGWsLlUJsmkF0hlbmCb6A1yYQW6muaUtumtDZt9Ousw1rKiGXK_LJlBRgY_CyVRnrw_GL82JQnIJamd1dEJj5aQDcMRC2a7jFEz01A7aJWBb1xpTBwuH2pjetxAD-zXz_oJYPHG4yA4_e-gY9xSMC6tjqb2blPDXUzmEegL9Bn44kNLtZtyrKVCBJypfmtwBTBgCvjRCuXs4mZvfDZV1MLT0fOudfneDERc0CsS-A",
        "status": 0
      },
      {
        "type": "UserInfo",
        "Name": {
          "GivenName": "尚豪",
          "FamilyName": "紀"
        },
        "Email": "slakchi@msn.com",
        "Location": {
          "StartTime": "2017-06-18T05:37:05Z",
          "EndTime": "2017-06-18T13:51:57Z",
          "Hub": {
            "Id": "6b04ac22-ebc6-4404-9652-77b4e95a2ac3",
            "Type": "Home",
            "Name": "home",
            "Latitude": 25.0597,
            "Longitude": 121.4595,
            "Address": "New Taipei City, New Taipei City"
          },
          "VenueName": "",
          "Away": false
        }
      },
      {
        "type": "DeviceInfo",
        "supportsDisplay": "true"
      }
    ],
    "channelData": {
      "skillId": "4eaed741-c622-4de9-9ab7-60d97f1a5143",
      "isDebug": true
    }
  },
  "botResponse": {
    "type": "message",
    "timestamp": "2017-06-18T14:50:08.1534861Z",
    "localTimestamp": "2017-06-18T07:50:05.8811026-07:00",
    "serviceUrl": "https://CortanaBFChannelWestUS.azurewebsites.net/",
    "channelId": "cortana",
    "from": {
      "id": "trendmeetingroombot"
    },
    "conversation": {
      "id": "642304c3-bc64-4796-8ae7-f7499aab04f0"
    },
    "recipient": {
      "id": "C809AFBF3AA1545032E7035492F897A0FAA3C09F16005BC443339BB3764BE82F"
    },
    "membersAdded": [],
    "membersRemoved": [],
    "locale": "en-US",
    "text": "Hello, I am Trend Micro Meeting Room bot, I am here to help you book meeting room efficiently\n\nYou can say \"book a room tomorrow morning 9 AM for 2 people\"\n\nOr \"book A901 next monday at 10 AM for 1 hour\"\n\n",
    "speak": "Hello, I am Trend Micro Meeting Room bot, I am here to help you book meeting room efficiently\n\nYou can say \"book a room tomorrow morning 9 AM for 2 people\"\n\nOr \"book A901 next monday at 10 AM for 1 hour\"\n\n",
    "inputHint": "expectingInput",
    "attachments": [],
    "entities": [],
    "replyToId": "H8T6XR4Q9u1"
  }
}


aud:https://graph.microsoft.com | iss:https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/ | iat:1497688985 | nbf:1497688985 | exp:1497692885 | acr:1 | aio:ASQA2/8DAAAAdgvh24bu6cqRkkuboKM/xFndqSEX5wTPsCF/c5J7+ow= | amr:pwd | amr:mfa | app_displayname:Trend Micro Meeting Room Bot | appid:e45a77b6-f948-4d2b-a8e6-4ea8d630acc8 | appidacr:1 | family_name:Chi | given_name:Michael SH | in_corp:true | ipaddr:1.34.144.17 | name:Michael SH Chi | oid:727c22fb-8982-4e16-ad51-1b707e137deb | onprem_sid:S-1-5-21-2146773085-903363285-719344707-1491898 | platf:3 | puid:10030000827FAFA2 | scp:User.Read | sub:G--JEyfQ0JZZwEN9xb00bE2XXIufAw2VbalAJYsGEIw | tid:72f988bf-86f1-41af-91ab-2d7cd011db47 | unique_name:michi@microsoft.com | upn:michi@microsoft.com | uti:XuihLXpMbEe2toEyA7sLAA | ver:1.0


{
  "botId": "trendmeetingroombot",
  "botRequest": {
    "type": "message",
    "id": "Cs95qsJML3Q",
    "timestamp": "2017-06-18T14:03:19.643545Z",
    "serviceUrl": "https://CortanaBFChannelWestUS.azurewebsites.net/",
    "channelId": "cortana",
    "from": {
      "id": "C809AFBF3AA1545032E7035492F897A0FAA3C09F16005BC443339BB3764BE82F"
    },
    "conversation": {
      "id": "2033a0a3-904d-4eb3-9e6d-7230a02e0478"
    },
    "recipient": {
      "id": "trendmeetingroombot"
    },
    "locale": "en-US",
    "text": "book a room tomorrow 9 am",
    "entities": [
      {
        "type": "Intent",
        "name": "None",
        "entities": [
          {
            "name": "builtin.datetime.date",
            "value": "tomorrow"
          },
          {
            "name": "builtin.datetime.time",
            "value": "9 am"
          },
          {
            "name": "builtin.number",
            "value": "9"
          }
        ]
      },
      {
        "type": "AuthorizationToken",
        "token": "eyJ0eXAiOiJKV1QiLCJub25jZSI6IkFRQUJBQUFBQUFCbmZpRy1tQTZOVGFlN0NkV1c3UWZkVGYwdHRCVTRXYW1jTmdud0tFdG52c2pyZWhReC02Y3gzaC1kTjRWOFY2M1M3T3VSeVFWMEFnaEg5ZGI3dWZRTHNIMUpLSUVnUmZzTm4wUXVBN0l5SmlBQSIsImFsZyI6IlJTMjU2IiwieDV0IjoiOUZYRHBiZk1GVDJTdlF1WGg4NDZZVHdFSUJ3Iiwia2lkIjoiOUZYRHBiZk1GVDJTdlF1WGg4NDZZVHdFSUJ3In0.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC83MmY5ODhiZi04NmYxLTQxYWYtOTFhYi0yZDdjZDAxMWRiNDcvIiwiaWF0IjoxNDk3NzkyNjc5LCJuYmYiOjE0OTc3OTI2NzksImV4cCI6MTQ5Nzc5NjU3OSwiYWNyIjoiMSIsImFpbyI6IlkyWmdZRml4dkVhVWI3S2Q5T3Rud3RsZHMrUlluZHN6WE9NdlQwK1ljcTlSdEhkR1NqOEEiLCJhbXIiOlsicHdkIiwibWZhIl0sImFwcF9kaXNwbGF5bmFtZSI6IlRyZW5kIE1pY3JvIE1lZXRpbmcgUm9vbSBCb3QiLCJhcHBpZCI6ImU0NWE3N2I2LWY5NDgtNGQyYi1hOGU2LTRlYThkNjMwYWNjOCIsImFwcGlkYWNyIjoiMSIsImZhbWlseV9uYW1lIjoiQ2hpIiwiZ2l2ZW5fbmFtZSI6Ik1pY2hhZWwgU0giLCJpbl9jb3JwIjoidHJ1ZSIsImlwYWRkciI6IjEuMzQuMTQ0LjE3IiwibmFtZSI6Ik1pY2hhZWwgU0ggQ2hpIiwib2lkIjoiNzI3YzIyZmItODk4Mi00ZTE2LWFkNTEtMWI3MDdlMTM3ZGViIiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTIxNDY3NzMwODUtOTAzMzYzMjg1LTcxOTM0NDcwNy0xNDkxODk4IiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMwMDAwODI3RkFGQTIiLCJzY3AiOiJVc2VyLlJlYWQiLCJzdWIiOiJHLS1KRXlmUTBKWlp3RU45eGIwMGJFMlhYSXVmQXcyVmJhbEFKWXNHRUl3IiwidGlkIjoiNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3IiwidW5pcXVlX25hbWUiOiJtaWNoaUBtaWNyb3NvZnQuY29tIiwidXBuIjoibWljaGlAbWljcm9zb2Z0LmNvbSIsInV0aSI6IjFrU2dUSWdpbEVLNzFQejc3cnNhQUEiLCJ2ZXIiOiIxLjAifQ.fhxpTc4StECBxFL5A4QwZKwUMw8gqvEDgfIOqrMoOroqhkCo0TU2bMJii7zf4RKXeu33MtlcWHykXaKEgTlCx-ioGwwrMnbqGh72GUNjp7cCmw4QETN3EsUxfWDcStW4KTXbZFL2WPY-RjNm2JkMmEKf88jbitzXVQKnx2TrEnQ-dxirspFbFkj6UXIIALeFhJDxAzRXze8M5-wmhwYS4tbJZmnfrYHZGFtmxElroeMLev9RkJKjZqZYzaXL6itqmi9467zNLXG20fb_LfL3P8Pnn3e5mtT0GquLsW9b_zayyblITuHV0Odz1Fe1_ac8-AVlsAtWQ0poRv6tsv2Mwg",
        "status": 0
      },
      {
        "type": "UserInfo",
        "Name": {
          "GivenName": "尚豪",
          "FamilyName": "紀"
        },
        "Email": "slakchi@msn.com"
      },
      {
        "type": "DeviceInfo",
        "supportsDisplay": "true"
      }
    ],
    "channelData": {
      "skillId": "4eaed741-c622-4de9-9ab7-60d97f1a5143",
      "isDebug": true
    }
  },
  "botResponse": {
    "type": "message",
    "timestamp": "2017-06-18T14:03:23.1104209Z",
    "localTimestamp": "2017-06-18T07:03:21.4875508-07:00",
    "serviceUrl": "https://CortanaBFChannelWestUS.azurewebsites.net/",
    "channelId": "cortana",
    "from": {
      "id": "trendmeetingroombot"
    },
    "conversation": {
      "id": "2033a0a3-904d-4eb3-9e6d-7230a02e0478"
    },
    "recipient": {
      "id": "C809AFBF3AA1545032E7035492F897A0FAA3C09F16005BC443339BB3764BE82F"
    },
    "membersAdded": [],
    "membersRemoved": [],
    "locale": "en-US",
    "text": "How many people would attend this meeting in-preson ?",
    "speak": "How many people would attend this meeting in-preson ?",
    "inputHint": "expectingInput",
    "attachments": [],
    "entities": [],
    "replyToId": "Cs95qsJML3Q"
  }
}





===ASA export to PBI
with temp as (
SELECT
*
from appinsights
OUTER APPLY GetElements(appinsights.event) as events
where
events.ArrayValue.name = 'Conversation'
)
select
temp.APPINSIGHTS.context.custom.dimensions as [Item],
temp.APPINSIGHTS.context.data.eventTime as [Time],
cast(GetRecordPropertyValue(GetArrayElement(temp.APPINSIGHTS.context.custom.dimensions, 0),'Longtitude') as float) as Longtitude,
cast(GetRecordPropertyValue(GetArrayElement(temp.APPINSIGHTS.context.custom.dimensions, 2),'Latitude') as float) as Latitude,
GetRecordPropertyValue(GetArrayElement(temp.APPINSIGHTS.context.custom.dimensions, 1),'Requestor') as Requestor,
GetRecordPropertyValue(GetArrayElement(temp.APPINSIGHTS.context.custom.dimensions, 3),'ConversationId') as ConversationId
into pbi
from temp

